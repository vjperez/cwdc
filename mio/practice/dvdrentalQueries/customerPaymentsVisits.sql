
dvdrental=# SELECT customer_id, count(payment_id), sum(amount)  FROM payment     GROUP BY customer_id     ORDER BY sum DESC  ;
 customer_id | count |  sum
-------------+-------+--------
         148 |    45 | 211.55
         526 |    42 | 208.58
         178 |    39 | 194.61
         137 |    38 | 191.62
         144 |    40 | 189.60
         459 |    37 | 183.63
         181 |    33 | 167.67
         410 |    38 | 167.62
         236 |    39 | 166.61
         403 |    33 | 162.67
         522 |    32 | 161.68
         469 |    35 | 158.65
         470 |    31 | 157.69
         373 |    34 | 156.66
         259 |    30 | 154.70
         468 |    34 | 154.66
         462 |    31 | 152.69
         372 |    32 | 152.68
         187 |    27 | 151.73
         550 |    31 | 151.69
         176 |    32 | 151.68
         532 |    31 | 149.69
          75 |    38 | 149.61
         209 |    29 | 147.71
          86 |    32 | 146.68
          26 |    32 | 146.68
          21 |    32 | 146.68
         211 |    33 | 146.67
         346 |    30 | 145.70
         366 |    36 | 145.64
          50 |    30 | 144.70
         360 |    32 | 144.68
         348 |    34 | 144.66
         513 |    30 | 143.70
         454 |    32 | 143.68
         347 |    30 | 142.70
		 
	
	
dvdrental=# SELECT customer_id, count(payment_id), sum(amount)  FROM payment     GROUP BY customer_id     ORDER BY count DESC  ;
 customer_id | count |  sum
-------------+-------+--------
         148 |    45 | 211.55
         526 |    42 | 208.58
         144 |    40 | 189.60
         236 |    39 | 166.61
         178 |    39 | 194.61
          75 |    38 | 149.61
         137 |    38 | 191.62
         410 |    38 | 167.62
         459 |    37 | 183.63
         366 |    36 | 145.64
           5 |    35 | 134.65
          29 |    35 | 138.65
         380 |    35 | 132.65
         469 |    35 | 158.65
         468 |    34 | 154.66
         348 |    34 | 144.66
          30 |    34 | 123.66
          91 |    34 | 107.66
         373 |    34 | 156.66
          38 |    34 | 127.66
         129 |    34 | 124.66
         257 |    34 | 142.66
         439 |    33 | 137.67
         181 |    33 | 167.67
          66 |    33 | 139.67
         211 |    33 | 146.67
         267 |    33 | 142.67
         354 |    33 | 125.67
         403 |    33 | 162.67
         241 |    32 | 110.68
         566 |    32 | 130.68
         138 |    32 | 106.68
	

	
dvdrental=# SELECT customer_id, count(payment_id), sum(amount)  FROM payment     GROUP BY customer_id     
			HAVING count(payment_id) > 35    ORDER BY count DESC  ;

 customer_id | count |  sum
-------------+-------+--------
         148 |    45 | 211.55
         526 |    42 | 208.58
         144 |    40 | 189.60
         236 |    39 | 166.61
         178 |    39 | 194.61
          75 |    38 | 149.61
         137 |    38 | 191.62
         410 |    38 | 167.62
         459 |    37 | 183.63
         366 |    36 | 145.64
(10 rows)